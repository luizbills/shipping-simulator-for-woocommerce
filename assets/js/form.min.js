window.addEventListener("DOMContentLoaded",()=>{const p=document,n=p.querySelector("#wc-shipping-sim-form"),m=p.querySelector("#wc-shipping-sim-results"),s=n.querySelector("#wc-shipping-sim .input-text"),o=n.querySelector("#wc-shipping-sim .button.submit"),g=p.querySelector("#wc-shipping-sim #nonce"),u=e=>e,i=window.wc_shipping_simulator={filterFormData:u,filterXHR:u,filterResults:u,filterProduct:u,filterQuantity:u,beforeSubmit:e=>{m.innerHTML="",s.disabled=!0,o.disabled=!0,o.classList.add("loading")},afterSubmit:e=>{s.disabled=!1,o.disabled=!1,o.classList.remove("loading")}},h=new Event("wc_shipping_simulator:init");if(p.dispatchEvent(h),n.addEventListener("submit",e=>{e.preventDefault();const l=b(),c=y();let d=`action=${n.dataset.ajaxAction}&nonce=${g.value}&postcode=${s.value}&product=${c.id}&quantity=${l>=1?l:1}`;d=i.filterFormData(d);let t=new XMLHttpRequest;t.open("GET",encodeURI(n.action+"?"+d),!0),t.onreadystatechange=()=>{if(XMLHttpRequest.DONE!==t.readyState)return;i.afterSubmit(t);const r=JSON.parse(t.responseText);r.success?m.innerHTML=i.filterResults(r.results_html?r.results_html:""):alert(r.error),console.log(t)},t=i.filterXHR(t),i.beforeSubmit(t),o.classList.add("loading"),t.send()}),s.dataset.mask){let e=function(l,c,d="X"){let t="";const r=(l+"").replace(/[^a-z0-9]/gi,"");for(let f=0,a=0,v=c.length;f<v&&r[a];f++)d===c[f]?(t+=r[a],a++):(t+=c[f]||"",a=a>0?a--:0);return t};var w=e;s.addEventListener("input",l=>{s.value=e(s.value||"",s.dataset.mask),s.maxLength=s.dataset.mask.length})}function y(){const e={type:n.dataset.productType,id:n.dataset.productId};return e.type,i.filterProduct(e)}function b(){let e=n.dataset.quantity?n.dataset.quantity|0:1;return i.filterQuantity(e)}});
