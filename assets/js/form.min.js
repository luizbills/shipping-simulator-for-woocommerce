window.addEventListener("DOMContentLoaded",(()=>{const t=document,e=t.querySelector("#wc-shipping-sim-form"),i=t.querySelector("#wc-shipping-sim-results"),n=e.querySelector("#wc-shipping-sim .input-text"),s=e.querySelector("#wc-shipping-sim .button.submit"),a=t.querySelector("#wc-shipping-sim #nonce"),r=t=>t,o=window.wc_shipping_simulator={filterFormData:r,filterXHR:r,filterResults:r,filterProduct:r,filterQuantity:r,beforeSubmit:t=>{i.innerHTML="",n.disabled=!0,s.disabled=!0,s.classList.add("loading")},afterSubmit:t=>{n.disabled=!1,s.disabled=!1,s.classList.remove("loading")}},l=new Event("wc_shipping_simulator:init");if(t.dispatchEvent(l),e.addEventListener("submit",(t=>{t.preventDefault();const r=function(){let t=e.dataset.quantity?0|e.dataset.quantity:1;return o.filterQuantity(t)}(),l=function(){const t={type:e.dataset.productType,id:e.dataset.productId};t.type;return o.filterProduct(t)}();let d=`action=${e.dataset.ajaxAction}&nonce=${a.value}&postcode=${n.value}&product=${l.id}&quantity=${r>=1?r:1}`;d=o.filterFormData(d);let u=new XMLHttpRequest;u.open("GET",encodeURI(e.action+"?"+d),!0),u.onreadystatechange=()=>{if(XMLHttpRequest.DONE!==u.readyState)return;o.afterSubmit(u);const t=JSON.parse(u.responseText);200===u.status&&(i.innerHTML=o.filterResults(t.results_html?t.results_html:"")),console.log(u)},u=o.filterXHR(u),o.beforeSubmit(u),s.classList.add("loading"),u.send()})),n.dataset.mask){n.addEventListener("input",(t=>{n.value=function(t,e,i="X"){let n="";const s=(t+"").replace(/[^a-z0-9]/gi,"");for(let t=0,a=0,r=e.length;t<r&&s[a];t++)i===e[t]?(n+=s[a],a++):(n+=e[t]||"",a=a>0?a--:0);return n}(n.value||"",n.dataset.mask),n.maxLength=n.dataset.mask.length}))}}));